<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö—Ä–æ—Ç–æ –ë–∏—Ç–≤–∞ - –ö–∏–±–µ—Ä–ø–∞–Ω–∫</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Orbitron', 'Arial', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap');
        
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            color: #00ff41;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 65, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(132, 0, 255, 0.1) 0%, transparent 40%);
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background: rgba(10, 10, 20, 0.9);
            border: 2px solid #00ff41;
            border-radius: 15px;
            box-shadow: 
                0 0 20px rgba(0, 255, 65, 0.3),
                inset 0 0 20px rgba(0, 255, 65, 0.1);
            overflow: hidden;
            position: relative;
            min-height: 500px;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff41, transparent);
            animation: scanline 3s linear infinite;
        }
        
        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100vh); }
        }
        
        .logout-top {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 28px;
            height: 28px;
            background: rgba(255, 65, 65, 0.2);
            border: 1px solid #ff4141;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 100;
            opacity: 0.7;
            touch-action: manipulation;
        }
        
        .logout-top:hover {
            opacity: 1;
            background: rgba(255, 65, 65, 0.4);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 65, 65, 0.6);
        }
        
        .logout-top::before {
            content: '‚úï';
            color: #ff4141;
            font-size: 14px;
            font-weight: bold;
        }
        
        .screen {
            padding: 20px;
            display: none;
            position: relative;
            min-height: 400px;
        }
        
        .active {
            display: block;
        }
        
        h1 {
            text-align: center;
            color: #00ff41;
            margin-bottom: 15px;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(0, 255, 65, 0.7);
            letter-spacing: 1px;
            position: relative;
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 20px;
            }
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 20%;
            right: 20%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #00ff41, transparent);
        }
        
        h2 {
            color: #00ff41;
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
            font-size: 18px;
        }
        
        @media (max-width: 480px) {
            h2 {
                font-size: 16px;
            }
        }
        
        .form-group {
            margin-bottom: 15px;
            position: relative;
        }
        
        .form-group::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, #00ff41, transparent);
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            color: #00ff41;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
            font-size: 14px;
        }
        
        @media (max-width: 480px) {
            label {
                font-size: 12px;
            }
        }
        
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #00ff41;
            border-radius: 5px;
            background: rgba(0, 20, 10, 0.7);
            color: #00ff41;
            font-size: 14px;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }
        
        @media (max-width: 480px) {
            input {
                padding: 10px;
                font-size: 13px;
            }
        }
        
        input:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
            border-color: #00ffaa;
        }
        
        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #003b00, #001100);
            color: #00ff41;
            border: 1px solid #00ff41;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
            touch-action: manipulation;
        }
        
        @media (max-width: 480px) {
            button {
                padding: 10px;
                font-size: 14px;
            }
        }
        
        button:hover {
            background: linear-gradient(135deg, #005500, #002200);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.6);
            transform: translateY(-1px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.4), transparent);
            transition: 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        .switch-form {
            text-align: center;
            margin-top: 15px;
            color: #00aa44;
            font-size: 13px;
        }
        
        @media (max-width: 480px) {
            .switch-form {
                font-size: 12px;
            }
        }
        
        .switch-form a {
            color: #00ffaa;
            text-decoration: none;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 255, 170, 0.5);
            position: relative;
        }
        
        .switch-form a:hover {
            text-shadow: 0 0 10px rgba(0, 255, 170, 0.8);
        }
        
        .switch-form a::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 0;
            height: 1px;
            background: #00ffaa;
            transition: width 0.3s;
        }
        
        .switch-form a:hover::after {
            width: 100%;
        }
        
        .game-container {
            text-align: center;
            padding: 15px 0;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }
        
        .mole-wrapper {
            position: relative;
            display: inline-block;
            margin: 15px auto;
        }
        
        .mole-image {
            width: 180px;
            height: 180px;
            cursor: pointer;
            transition: all 0.1s;
            user-select: none;
            border-radius: 50%;
            border: 2px solid #00ff41;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
            position: relative;
            overflow: hidden;
            animation: float 3s ease-in-out infinite;
            display: block;
            touch-action: manipulation;
        }
        
        @media (max-width: 480px) {
            .mole-image {
                width: 150px;
                height: 150px;
            }
        }
        
        @media (max-width: 320px) {
            .mole-image {
                width: 130px;
                height: 130px;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
        
        .mole-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, transparent 60%, rgba(0, 255, 65, 0.1));
            pointer-events: none;
        }
        
        .mole-image:active {
            transform: scale(0.92) !important;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.6);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            background: rgba(0, 30, 15, 0.3);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 65, 0.3);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
        }
        
        @media (max-width: 480px) {
            .stats {
                padding: 10px;
                margin: 10px 0;
            }
        }
        
        .stat-item {
            text-align: center;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #00ff41;
            text-shadow: 0 0 10px rgba(0, 255, 65, 0.7);
        }
        
        @media (max-width: 480px) {
            .stat-value {
                font-size: 18px;
            }
        }
        
        .stat-label {
            font-size: 12px;
            color: #00aa44;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        @media (max-width: 480px) {
            .stat-label {
                font-size: 10px;
            }
        }
        
        .message {
            padding: 12px;
            border-radius: 5px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            border: 1px solid;
            position: relative;
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
            font-size: 13px;
        }
        
        @media (max-width: 480px) {
            .message {
                padding: 10px;
                font-size: 12px;
                margin: 10px 0;
            }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .success {
            background: rgba(0, 40, 0, 0.3);
            color: #00ff41;
            border-color: #00ff41;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
        }
        
        .error {
            background: rgba(40, 0, 0, 0.3);
            color: #ff4141;
            border-color: #ff4141;
            box-shadow: 0 0 15px rgba(255, 65, 65, 0.3);
        }
        
        .hidden {
            display: none;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 3px solid rgba(0, 255, 65, 0.1);
            border-radius: 50%;
            border-top: 3px solid #00ff41;
            width: 35px;
            height: 35px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
        }
        
        @media (max-width: 480px) {
            .spinner {
                width: 30px;
                height: 30px;
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .glitch {
            position: relative;
            animation: glitch-text 5s infinite;
        }
        
        @keyframes glitch-text {
            0%, 100% { transform: translate(0); }
            10% { transform: translate(-1px, 1px); }
            20% { transform: translate(1px, -1px); }
            30% { transform: translate(-1px, -1px); }
            40% { transform: translate(1px, 1px); }
        }
        
        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .glitch::before {
            left: 1px;
            text-shadow: -1px 0 #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }
        
        .glitch::after {
            left: -1px;
            text-shadow: -1px 0 #00fff9, 1px 1px #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }
        
        @keyframes glitch-anim {
            0% { clip: rect(42px, 9999px, 44px, 0); }
            5% { clip: rect(12px, 9999px, 59px, 0); }
            10% { clip: rect(48px, 9999px, 29px, 0); }
            15% { clip: rect(42px, 9999px, 73px, 0); }
            20% { clip: rect(63px, 9999px, 27px, 0); }
            25% { clip: rect(34px, 9999px, 55px, 0); }
            30% { clip: rect(86px, 9999px, 73px, 0); }
            35% { clip: rect(20px, 9999px, 20px, 0); }
            40% { clip: rect(26px, 9999px, 60px, 0); }
            45% { clip: rect(25px, 9999px, 66px, 0); }
            50% { clip: rect(57px, 9999px, 98px, 0); }
            55% { clip: rect(5px, 9999px, 46px, 0); }
            60% { clip: rect(82px, 9999px, 31px, 0); }
            65% { clip: rect(54px, 9999px, 27px, 0); }
            70% { clip: rect(28px, 9999px, 99px, 0); }
            75% { clip: rect(45px, 9999px, 69px, 0); }
            80% { clip: rect(23px, 9999px, 85px, 0); }
            85% { clip: rect(1px, 9999px, 83px, 0); }
            90% { clip: rect(72px, 9999px, 11px, 0); }
            95% { clip: rect(60px, 9999px, 89px, 0); }
            100% { clip: rect(52px, 9999px, 74px, 0); }
        }
        
        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 100px, 0); }
            5% { clip: rect(52px, 9999px, 74px, 0); }
            10% { clip: rect(79px, 9999px, 85px, 0); }
            15% { clip: rect(75px, 9999px, 5px, 0); }
            20% { clip: rect(67px, 9999px, 61px, 0); }
            25% { clip: rect(14px, 9999px, 79px, 0); }
            30% { clip: rect(1px, 9999px, 66px, 0); }
            35% { clip: rect(86px, 9999px, 30px, 0); }
            40% { clip: rect(23px, 9999px, 98px, 0); }
            45% { clip: rect(85px, 9999px, 72px, 0); }
            50% { clip: rect(71px, 9999px, 75px, 0); }
            55% { clip: rect(2px, 9999px, 48px, 0); }
            60% { clip: rect(30px, 9999px, 16px, 0); }
            65% { clip: rect(59px, 9999px, 50px, 0); }
            70% { clip: rect(41px, 9999px, 62px, 0); }
            75% { clip: rect(2px, 9999px, 82px, 0); }
            80% { clip: rect(47px, 9999px, 73px, 0); }
            85% { clip: rect(3px, 9999px, 27px, 0); }
            90% { clip: rect(26px, 9999px, 55px, 0); }
            95% { clip: rect(42px, 9999px, 97px, 0); }
            100% { clip: rect(38px, 9999px, 49px, 0); }
        }
        
        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            opacity: 0.1;
            pointer-events: none;
        }
        
        .tap-effect {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 2px solid #00ff41;
            border-radius: 50%;
            pointer-events: none;
            animation: tap-ripple 0.6s ease-out;
            transform: translate(-50%, -50%);
            left: 0;
            top: 0;
        }
        
        @media (max-width: 480px) {
            .tap-effect {
                width: 35px;
                height: 35px;
            }
        }
        
        @keyframes tap-ripple {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(2.5);
                opacity: 0;
            }
        }
        
        .level-up {
            animation: levelUp 1s ease-out;
        }
        
        @keyframes levelUp {
            0% { transform: scale(1); }
            25% { transform: scale(1.2); }
            50% { transform: scale(0.9); }
            75% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-tabs {
            display: flex;
            margin: 15px 0;
            border-bottom: 1px solid rgba(0, 255, 65, 0.3);
            flex-wrap: wrap;
        }
        
        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
            font-size: 12px;
            font-weight: bold;
            min-width: 70px;
        }
        
        @media (max-width: 480px) {
            .nav-tab {
                padding: 8px 4px;
                font-size: 10px;
            }
        }
        
        .nav-tab.active {
            border-bottom: 2px solid #00ff41;
            color: #00ff41;
        }
        
        .nav-tab:not(.active):hover {
            background: rgba(0, 255, 65, 0.1);
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ */
        .leaderboard-container {
            margin-top: 20px;
            max-height: 350px;
            overflow-y: auto;
        }
        
        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            background: rgba(0, 30, 15, 0.5);
            padding: 12px;
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 5px 5px 0 0;
            font-weight: bold;
            font-size: 14px;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
            font-size: 13px;
            transition: background 0.3s;
        }
        
        .leaderboard-item:hover {
            background: rgba(0, 255, 65, 0.1);
        }
        
        .leaderboard-rank {
            width: 35px;
            text-align: center;
            font-weight: bold;
        }
        
        .leaderboard-username {
            flex: 1;
            text-align: left;
            padding: 0 12px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .leaderboard-score {
            width: 90px;
            text-align: right;
            font-weight: bold;
            color: #00ff41;
        }
        
        .refresh-btn {
            width: auto;
            padding: 10px 20px;
            font-size: 14px;
            margin: 20px auto;
            display: block;
        }
        
        .auto-refresh {
            text-align: center;
            font-size: 12px;
            color: #00aa44;
            margin-top: 10px;
        }
        
        .auto-refresh span {
            color: #00ff41;
            font-weight: bold;
        }
        
        /* –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
        .achievements-container {
            margin-top: 20px;
            max-height: 350px;
            overflow-y: auto;
        }
        
        .achievement-item {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
            font-size: 13px;
            background: rgba(0, 20, 10, 0.2);
            border-radius: 5px;
            margin-bottom: 10px;
            position: relative;
        }
        
        .achievement-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0, 255, 65, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .achievement-locked {
            background: rgba(100, 100, 100, 0.2);
            opacity: 0.5;
        }
        
        .achievement-info {
            flex: 1;
            margin-right: 10px;
        }
        
        .achievement-name {
            font-weight: bold;
            color: #00ff41;
            margin-bottom: 5px;
        }
        
        .achievement-desc {
            font-size: 12px;
            color: #00aa44;
            margin-bottom: 5px;
        }
        
        .achievement-reward {
            font-size: 12px;
            color: #ffaa00;
            font-weight: bold;
        }
        
        .achievement-claim-btn {
            padding: 8px 12px;
            font-size: 11px;
            background: linear-gradient(135deg, #ff8c00, #ff4500);
            border: 1px solid #ffaa00;
            flex-shrink: 0;
            height: fit-content;
            align-self: center;
        }
        
        .achievement-claimed {
            background: linear-gradient(135deg, #333, #222);
            border: 1px solid #555;
            opacity: 0.7;
        }
        
        /* –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã */
        .daily-reward-container {
            text-align: center;
            margin-top: 20px;
        }
        
        .daily-reward-info {
            background: rgba(0, 30, 15, 0.3);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 65, 0.3);
            margin-bottom: 20px;
        }
        
        .daily-streak {
            font-size: 18px;
            font-weight: bold;
            color: #00ff41;
            margin-bottom: 10px;
        }
        
        .daily-timer {
            font-size: 14px;
            color: #00aa44;
            margin-bottom: 15px;
        }
        
        .daily-reward-btn {
            background: linear-gradient(135deg, #ff8c00, #ff4500);
            border: 1px solid #ffaa00;
        }
        
        .daily-reward-btn:disabled {
            background: linear-gradient(135deg, #333, #222);
            border: 1px solid #555;
            opacity: 0.5;
        }
        
        /* –°–∫–∏–Ω—ã */
        .skins-container {
            margin-top: 20px;
            max-height: 350px;
            overflow-y: auto;
        }
        
        .skin-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
            font-size: 14px;
            background: rgba(0, 20, 10, 0.2);
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .skin-info {
            flex: 1;
            text-align: left;
        }
        
        .skin-name {
            font-weight: bold;
            color: #00ff41;
        }
        
        .skin-price {
            font-size: 13px;
            color: #ffaa00;
            margin-top: 5px;
        }
        
        .skin-owned {
            font-size: 12px;
            color: #00ff41;
            margin-top: 5px;
        }
        
        .skin-equip-btn {
            padding: 8px 15px;
            font-size: 12px;
            background: linear-gradient(135deg, #003b00, #001100);
        }
        
        .skin-buy-btn {
            padding: 8px 15px;
            font-size: 12px;
            background: linear-gradient(135deg, #ff8c00, #ff4500);
        }
        
        .skin-current {
            background: rgba(0, 255, 65, 0.2);
        }
        
        /* –ë–æ–Ω—É—Å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã */
        .bonus-container {
            margin-top: 20px;
        }
        
        .bonus-shop {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
            margin-bottom: 20px;
        }
        
        .bonus-item {
            background: rgba(0, 30, 15, 0.3);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .bonus-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 65, 0.3);
        }
        
        .bonus-item:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .bonus-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: #00ff41;
        }
        
        .bonus-name {
            font-size: 14px;
            font-weight: bold;
            color: #00ff41;
            margin-bottom: 5px;
        }
        
        .bonus-price {
            font-size: 12px;
            color: #ffaa00;
            margin-bottom: 10px;
        }
        
        .bonus-count {
            font-size: 12px;
            color: #00ff41;
            font-weight: bold;
        }
        
        .inventory-title {
            text-align: center;
            margin: 20px 0 10px 0;
            color: #00ff41;
            font-size: 16px;
        }
        
        .inventory-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 10px;
        }
        
        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è */
        .events-container {
            margin-top: 20px;
            max-height: 350px;
            overflow-y: auto;
        }
        
        .event-item {
            background: rgba(0, 30, 15, 0.3);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .event-title {
            font-size: 16px;
            font-weight: bold;
            color: #00ff41;
            margin-bottom: 10px;
        }
        
        .event-desc {
            font-size: 13px;
            color: #00aa44;
            margin-bottom: 10px;
        }
        
        .event-progress {
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .event-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff41, #00aa44);
            border-radius: 5px;
            transition: width 0.5s;
        }
        
        .event-info {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #00aa44;
        }
        
        .event-reward {
            font-size: 13px;
            color: #ffaa00;
            font-weight: bold;
            margin-top: 10px;
        }
        
        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
        .leaderboard-container::-webkit-scrollbar,
        .achievements-container::-webkit-scrollbar,
        .skins-container::-webkit-scrollbar,
        .events-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .leaderboard-container::-webkit-scrollbar-track,
        .achievements-container::-webkit-scrollbar-track,
        .skins-container::-webkit-scrollbar-track,
        .events-container::-webkit-scrollbar-track {
            background: rgba(0, 20, 10, 0.3);
        }
        
        .leaderboard-container::-webkit-scrollbar-thumb,
        .achievements-container::-webkit-scrollbar-thumb,
        .skins-container::-webkit-scrollbar-thumb,
        .events-container::-webkit-scrollbar-thumb {
            background: #00ff41;
            border-radius: 3px;
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-height: 600px) {
            .container {
                min-height: 450px;
            }
            
            .screen {
                padding: 15px;
                min-height: 350px;
            }
            
            .mole-image {
                width: 140px;
                height: 140px;
            }
            
            .game-container {
                min-height: 250px;
            }
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ */
        @media (min-width: 768px) and (max-width: 1024px) {
            .container {
                max-width: 600px;
            }
            
            .mole-image {
                width: 220px;
                height: 220px;
            }
            
            .stat-value {
                font-size: 22px;
            }
            
            h1 {
                font-size: 26px;
            }
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤ */
        @media (min-width: 1025px) {
            .container {
                max-width: 650px;
            }
            
            .mole-image {
                width: 240px;
                height: 240px;
            }
            
            .stat-value {
                font-size: 24px;
            }
            
            h1 {
                font-size: 28px;
            }
            
            button {
                font-size: 18px;
            }
            
            .nav-tab {
                font-size: 14px;
                padding: 12px;
            }
        }
        
        /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (hover: none) and (pointer: coarse) {
            .logout-top:hover {
                opacity: 0.7;
                background: rgba(255, 65, 65, 0.2);
                transform: scale(1);
                box-shadow: none;
            }
            
            button:hover {
                background: linear-gradient(135deg, #003b00, #001100);
                box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
                transform: translateY(0);
            }
            
            .switch-form a:hover {
                text-shadow: 0 0 5px rgba(0, 255, 170, 0.5);
            }
            
            .switch-form a:hover::after {
                width: 0;
            }
            
            .nav-tab.active {
                background: rgba(0, 255, 65, 0.1);
            }
        }
        
        /* –§–∏–∫—Å –¥–ª—è iOS Safari */
        input, button {
            -webkit-appearance: none;
            border-radius: 5px;
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å–∞–Ω–∏–π */
        .tap-highlight {
            -webkit-tap-highlight-color: rgba(0, 255, 65, 0.1);
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrix"></canvas>
    
    <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loading-screen" class="screen active">
            <div class="loading">
                <div class="spinner"></div>
                <h2>–ó–ê–ì–†–£–ó–ö–ê –°–ò–°–¢–ï–ú–´...</h2>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="register-screen" class="screen">
            <h1 class="glitch" data-text="–ö–†–û–¢–û –ë–ò–¢–í–ê">–ö–†–û–¢–û –ë–ò–¢–í–ê</h1>
            <h2>–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h2>
            <div id="register-message" class="message hidden"></div>
            <form id="register-form">
                <div class="form-group">
                    <label for="register-username">–õ–û–ì–ò–ù</label>
                    <input type="text" id="register-username" required minlength="3" maxlength="20" autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="register-password">–ü–ê–†–û–õ–¨</label>
                    <input type="password" id="register-password" required minlength="6" autocomplete="new-password">
                </div>
                <button type="submit">–°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
            </form>
            <div class="switch-form">
                –£–ñ–ï –í –°–ò–°–¢–ï–ú–ï? <a href="#" id="show-login">–í–•–û–î</a>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
        <div id="login-screen" class="screen">
            <h1 class="glitch" data-text="–ö–†–û–¢–û –ë–ò–¢–í–ê">–ö–†–û–¢–û –ë–ò–¢–í–ê</h1>
            <h2>–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø</h2>
            <div id="login-message" class="message hidden"></div>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-username">–õ–û–ì–ò–ù</label>
                    <input type="text" id="login-username" required autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="login-password">–ü–ê–†–û–õ–¨</label>
                    <input type="password" id="login-password" required autocomplete="current-password">
                </div>
                <button type="submit">–í–û–ô–¢–ò –í –°–ò–°–¢–ï–ú–£</button>
            </form>
            <div class="switch-form">
                –ù–ï–¢ –ê–ö–ö–ê–£–ù–¢–ê? <a href="#" id="show-register">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</a>
            </div>
        </div>
        
        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="game-screen" class="screen">
            <div class="logout-top" id="logout-top" title="–í—ã—Ö–æ–¥"></div>
            <h1 class="glitch" data-text="–ö–†–û–¢–û –ë–ò–¢–í–ê">–ö–†–û–¢–û –ë–ò–¢–í–ê</h1>
            
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ -->
            <div class="nav-tabs">
                <div class="nav-tab active" data-tab="game">–ò–ì–†–ê</div>
                <div class="nav-tab" data-tab="leaderboard">–õ–ò–î–ï–†–´</div>
                <div class="nav-tab" data-tab="achievements">–î–û–°–¢–ò–ñ–ï–ù–ò–Ø</div>
                <div class="nav-tab" data-tab="daily">–ù–ê–ì–†–ê–î–´</div>
                <div class="nav-tab" data-tab="skins">–°–ö–ò–ù–´</div>
                <div class="nav-tab" data-tab="bonus">–ë–û–ù–£–°–´</div>
                <div class="nav-tab" data-tab="events">–°–û–ë–´–¢–ò–Ø</div>
            </div>
            
            <!-- –ò–≥—Ä–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ -->
            <div id="game-tab" class="tab-content">
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="coins">0</div>
                        <div class="stat-label">–ú–û–ù–ï–¢–´</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="level">1</div>
                        <div class="stat-label">–£–†–û–í–ï–ù–¨</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="clicks">0</div>
                        <div class="stat-label">–£–î–ê–†–´</div>
                    </div>
                </div>
                <div class="game-container">
                    <div class="mole-wrapper">
                        <img src="/mouse.png" alt="–ö–∏–±–µ—Ä –ö—Ä–æ—Ç" class="mole-image" id="mole">
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤ -->
            <div id="leaderboard-tab" class="tab-content hidden">
                <div class="leaderboard-container">
                    <div class="leaderboard-header">
                        <div class="leaderboard-rank">#</div>
                        <div class="leaderboard-username">–ò–ì–†–û–ö</div>
                        <div class="leaderboard-score">–ú–û–ù–ï–¢–´</div>
                    </div>
                    <div id="leaderboard-list">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–ê–ì–†–£–ó–ö–ê –õ–ò–î–ï–†–û–í...</p>
                        </div>
                    </div>
                </div>
                <button class="refresh-btn" id="refresh-leaderboard">–û–ë–ù–û–í–ò–¢–¨</button>
                <div class="auto-refresh">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="refresh-timer">30</span>—Å</div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
            <div id="achievements-tab" class="tab-content hidden">
                <div class="achievements-container">
                    <div id="achievements-list">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–ê–ì–†–£–ó–ö–ê –î–û–°–¢–ò–ñ–ï–ù–ò–ô...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥ -->
            <div id="daily-tab" class="tab-content hidden">
                <div class="daily-reward-container">
                    <div class="daily-reward-info">
                        <div class="daily-streak">–°–µ—Ä–∏—è –¥–Ω–µ–π: <span id="streak-count">0</span></div>
                        <div class="daily-timer" id="daily-timer">–°–ª–µ–¥—É—é—â–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞</div>
                        <button class="daily-reward-btn" id="claim-daily-reward">–ü–û–õ–£–ß–ò–¢–¨ –ù–ê–ì–†–ê–î–£</button>
                    </div>
                    <div id="daily-message" class="message hidden"></div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ —Å–∫–∏–Ω–æ–≤ -->
            <div id="skins-tab" class="tab-content hidden">
                <div class="skins-container">
                    <div id="skins-list">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–ê–ì–†–£–ó–ö–ê –°–ö–ò–ù–û–í...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –±–æ–Ω—É—Å–æ–≤ -->
            <div id="bonus-tab" class="tab-content hidden">
                <div class="bonus-container">
                    <h2 style="text-align: center; margin-bottom: 20px;">–ú–ê–ì–ê–ó–ò–ù –ë–û–ù–£–°–û–í</h2>
                    <div class="bonus-shop" id="bonus-shop">
                        <div class="bonus-item" data-item="double_points">
                            <div class="bonus-icon">‚ö°</div>
                            <div class="bonus-name">–£–¥–≤–æ–µ–Ω–∏–µ –º–æ–Ω–µ—Ç</div>
                            <div class="bonus-price">200 –º–æ–Ω–µ—Ç</div>
                        </div>
                        <div class="bonus-item" data-item="auto_click">
                            <div class="bonus-icon">üñ±Ô∏è</div>
                            <div class="bonus-name">–ê–≤—Ç–æ–∫–ª–∏–∫</div>
                            <div class="bonus-price">150 –º–æ–Ω–µ—Ç</div>
                        </div>
                        <div class="bonus-item" data-item="coin_boost">
                            <div class="bonus-icon">üíé</div>
                            <div class="bonus-name">–ë–æ–Ω—É—Å –º–æ–Ω–µ—Ç</div>
                            <div class="bonus-price">100 –º–æ–Ω–µ—Ç</div>
                        </div>
                        <div class="bonus-item" data-item="lucky_drop">
                            <div class="bonus-icon">üéÅ</div>
                            <div class="bonus-name">–£–¥–∞—á–Ω—ã–π –¥—Ä–æ–ø</div>
                            <div class="bonus-price">300 –º–æ–Ω–µ—Ç</div>
                        </div>
                    </div>
                    
                    <div class="inventory-title">–ò–ù–í–ï–ù–¢–ê–†–¨</div>
                    <div class="inventory-items" id="inventory-items">
                        <div class="bonus-item" data-item="double_points">
                            <div class="bonus-icon">‚ö°</div>
                            <div class="bonus-name">–£–¥–≤–æ–µ–Ω–∏–µ –º–æ–Ω–µ—Ç</div>
                            <div class="bonus-count" id="double_points-count">0</div>
                        </div>
                        <div class="bonus-item" data-item="auto_click">
                            <div class="bonus-icon">üñ±Ô∏è</div>
                            <div class="bonus-name">–ê–≤—Ç–æ–∫–ª–∏–∫</div>
                            <div class="bonus-count" id="auto_click-count">0</div>
                        </div>
                        <div class="bonus-item" data-item="coin_boost">
                            <div class="bonus-icon">üíé</div>
                            <div class="bonus-name">–ë–æ–Ω—É—Å –º–æ–Ω–µ—Ç</div>
                            <div class="bonus-count" id="coin_boost-count">0</div>
                        </div>
                        <div class="bonus-item" data-item="lucky_drop">
                            <div class="bonus-icon">üéÅ</div>
                            <div class="bonus-name">–£–¥–∞—á–Ω—ã–π –¥—Ä–æ–ø</div>
                            <div class="bonus-count" id="lucky_drop-count">0</div>
                        </div>
                    </div>
                    <div id="bonus-message" class="message hidden" style="margin-top: 20px;"></div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ —Å–æ–±—ã—Ç–∏–π -->
            <div id="events-tab" class="tab-content hidden">
                <div class="events-container">
                    <div id="events-list">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–ê–ì–†–£–ó–ö–ê –°–û–ë–´–¢–ò–ô...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ú–∞—Ç—Ä–∏—á–Ω—ã–π —Ñ–æ–Ω
        function initMatrix() {
            const canvas = document.getElementById('matrix');
            const ctx = canvas.getContext('2d');
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            resizeCanvas();
            
            const chars = '–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ$#@%&*';
            const charArray = chars.split('');
            
            let fontSize = Math.max(10, Math.min(16, window.innerWidth / 30));
            let columns = Math.floor(canvas.width / fontSize);
            
            const drops = [];
            for (let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
            
            function draw() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#00ff41';
                ctx.font = `${fontSize}px Orbitron`;
                
                for (let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    
                    drops[i]++;
                }
            }
            
            const interval = setInterval(draw, 50);
            
            window.addEventListener('resize', () => {
                resizeCanvas();
                fontSize = Math.max(10, Math.min(16, window.innerWidth / 30));
                columns = Math.floor(canvas.width / fontSize);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Å—Å–∏–≤ –∫–∞–ø–µ–ª—å
                while (drops.length < columns) {
                    drops.push(1);
                }
                drops.length = columns;
            });
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
            window.addEventListener('beforeunload', () => {
                clearInterval(interval);
            });
        }
        
        // –ó–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
        class SoundManager {
            constructor() {
                // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–≤—É–∫–æ–≤
            }
            
            createTapSound() {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + 0.1);
                } catch (e) {
                    console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
            }
            
            createLevelUpSound() {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                    oscillator.frequency.exponentialRampToValueAtTime(783.99, audioCtx.currentTime + 0.3); // G5
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                    
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + 0.3);
                } catch (e) {
                    console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
            }
            
            createLoginSound() {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(659.25, audioCtx.currentTime); // E5
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + 0.2);
                } catch (e) {
                    console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
            }
            
            createLogoutSound() {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(329.63, audioCtx.currentTime); // E4
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + 0.2);
                } catch (e) {
                    console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
            }
            
            createAchievementSound() {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(783.99, audioCtx.currentTime); // G5
                    oscillator.frequency.exponentialRampToValueAtTime(1046.50, audioCtx.currentTime + 0.5); // C6
                    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                    
                    oscillator.start(audioCtx.currentTime);
                    oscillator.stop(audioCtx.currentTime + 0.5);
                } catch (e) {
                    console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
            }
            
            play(soundName) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞
                switch(soundName) {
                    case 'tap':
                        this.createTapSound();
                        break;
                    case 'levelUp':
                        this.createLevelUpSound();
                        break;
                    case 'login':
                        this.createLoginSound();
                        break;
                    case 'logout':
                        this.createLogoutSound();
                        break;
                    case 'achievement':
                        this.createAchievementSound();
                        break;
                }
            }
        }
        
        class Game {
            constructor() {
                this.token = localStorage.getItem('token');
                this.user = null;
                this.coins = 0;
                this.level = 1;
                this.clicks = 0;
                this.saveTimeout = null;
                this.soundManager = new SoundManager();
                this.lastLevel = 1;
                this.leaderboardInterval = null;
                this.refreshTimer = 30;
                this.achievements = {};
                this.dailyStreak = 0;
                this.lastDailyReward = null;
                this.skins = ['default'];
                this.currentSkin = 'default';
                this.bonusItems = {};
                this.eventProgress = {};
                this.doublePointsActive = false;
                this.doublePointsTime = 0;
                this.init();
            }
            
            init() {
                initMatrix();
                this.bindEvents();
                this.checkAuth();
                this.preventZoom();
                this.initDailyTimer();
            }
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑—É–º–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
            preventZoom() {
                // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑—É–º–∞ –ø–∏–Ω—á–∞–º–∏
                document.addEventListener('gesturestart', function(e) {
                    e.preventDefault();
                });
                
                document.addEventListener('gesturechange', function(e) {
                    e.preventDefault();
                });
                
                document.addEventListener('gestureend', function(e) {
                    e.preventDefault();
                });
                
                // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑—É–º–∞ –¥–≤–æ–π–Ω—ã–º —Ç–∞–ø–æ–º
                let lastTouchEnd = 0;
                document.addEventListener('touchend', function(event) {
                    const now = (new Date()).getTime();
                    if (now - lastTouchEnd <= 300) {
                        event.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
            
            bindEvents() {
                // –§–æ—Ä–º—ã
                document.getElementById('register-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.register();
                });
                
                document.getElementById('login-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.login();
                });
                
                document.getElementById('show-login').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showScreen('login-screen');
                });
                
                document.getElementById('show-register').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showScreen('register-screen');
                });
                
                document.getElementById('logout-top').addEventListener('click', () => {
                    this.logout();
                });
                
                // –ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞
                document.getElementById('mole').addEventListener('click', (e) => {
                    this.tap(e);
                });
                
                // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∞—á-—Å–æ–±—ã—Ç–∏–π
                document.getElementById('mole').addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.tap(e.touches[0]);
                }, { passive: false });
                
                // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const tabName = e.target.getAttribute('data-tab');
                        this.switchTab(tabName);
                    });
                });
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤
                document.getElementById('refresh-leaderboard').addEventListener('click', () => {
                    this.loadLeaderboard();
                });
                
                // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã
                document.getElementById('claim-daily-reward').addEventListener('click', () => {
                    this.claimDailyReward();
                });
                
                // –ë–æ–Ω—É—Å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã - –ø–æ–∫—É–ø–∫–∞
                document.querySelectorAll('.bonus-item[data-item]').forEach(item => {
                    if (item.closest('#bonus-shop')) {
                        item.addEventListener('click', (e) => {
                            const itemId = e.currentTarget.getAttribute('data-item');
                            this.buyBonusItem(itemId);
                        });
                    }
                });
                
                // –ë–æ–Ω—É—Å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
                document.querySelectorAll('.bonus-item[data-item]').forEach(item => {
                    if (item.closest('#inventory-items')) {
                        item.addEventListener('click', (e) => {
                            const itemId = e.currentTarget.getAttribute('data-item');
                            this.useBonusItem(itemId);
                        });
                    }
                });
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫—Ä–æ—Ç–∞
                const mole = document.getElementById('mole');
                mole.addEventListener('mouseenter', () => {
                    mole.style.animation = 'none';
                    setTimeout(() => {
                        mole.style.animation = 'float 1s ease-in-out';
                    }, 10);
                });
            }
            
            switchTab(tabName) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                document.getElementById(`${tabName}-tab`).classList.remove('hidden');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –≤–∫–ª–∞–¥–∫–∏
                switch(tabName) {
                    case 'leaderboard':
                        this.loadLeaderboard();
                        this.startAutoRefresh();
                        break;
                    case 'achievements':
                        this.loadAchievements();
                        break;
                    case 'daily':
                        this.loadDailyReward();
                        break;
                    case 'skins':
                        this.loadSkins();
                        break;
                    case 'bonus':
                        this.loadBonusItems();
                        break;
                    case 'events':
                        this.loadEvents();
                        break;
                    default:
                        this.stopAutoRefresh();
                }
            }
            
            startAutoRefresh() {
                this.stopAutoRefresh(); // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
                
                this.refreshTimer = 30;
                this.updateRefreshTimer();
                
                this.leaderboardInterval = setInterval(() => {
                    this.refreshTimer--;
                    this.updateRefreshTimer();
                    
                    if (this.refreshTimer <= 0) {
                        this.loadLeaderboard();
                        this.refreshTimer = 30;
                    }
                }, 1000);
            }
            
            stopAutoRefresh() {
                if (this.leaderboardInterval) {
                    clearInterval(this.leaderboardInterval);
                    this.leaderboardInterval = null;
                }
            }
            
            updateRefreshTimer() {
                const timerElement = document.getElementById('refresh-timer');
                if (timerElement) {
                    timerElement.textContent = this.refreshTimer;
                }
            }
            
            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            }
            
            showMessage(elementId, message, isSuccess = true) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = message;
                    element.className = `message ${isSuccess ? 'success' : 'error'}`;
                    element.classList.remove('hidden');
                    
                    setTimeout(() => {
                        element.classList.add('hidden');
                    }, 3000);
                }
            }
            
            async register() {
                const username = document.getElementById('register-username').value;
                const password = document.getElementById('register-password').value;
                
                try {
                    const response = await fetch('/api/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.token = data.token;
                        this.user = data.user;
                        localStorage.setItem('token', this.token);
                        this.soundManager.play('login');
                        this.showMessage('register-message', '–ê–ö–ö–ê–£–ù–¢ –°–û–ó–î–ê–ù!', true);
                        setTimeout(() => {
                            this.showScreen('game-screen');
                            this.updateUI();
                        }, 1500);
                    } else {
                        this.showMessage('register-message', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('register-message', '–û–®–ò–ë–ö–ê –°–ï–¢–ò', false);
                }
            }
            
            async login() {
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                
                try {
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.token = data.token;
                        this.user = data.user;
                        localStorage.setItem('token', this.token);
                        this.soundManager.play('login');
                        this.loadUserData();
                        this.showScreen('game-screen');
                    } else {
                        this.showMessage('login-message', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('login-message', '–û–®–ò–ë–ö–ê –°–ï–¢–ò', false);
                }
            }
            
            async checkAuth() {
                if (this.token) {
                    try {
                        const response = await fetch('/api/user', {
                            headers: {
                                'Authorization': `Bearer ${this.token}`
                            }
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            this.user = data.user;
                            this.loadUserData();
                            this.showScreen('game-screen');
                        } else {
                            this.showScreen('register-screen');
                        }
                    } catch (error) {
                        this.showScreen('register-screen');
                    }
                } else {
                    this.showScreen('register-screen');
                }
                
                // –°–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
                setTimeout(() => {
                    document.getElementById('loading-screen').style.display = 'none';
                }, 1000);
            }
            
            loadUserData() {
                if (this.user) {
                    this.coins = this.user.coins || 0;
                    this.level = this.user.level || 1;
                    this.clicks = this.user.clicks || 0;
                    this.lastLevel = this.level;
                    this.achievements = this.user.achievements || {};
                    this.dailyStreak = this.user.dailyStreak || 0;
                    this.lastDailyReward = this.user.lastDailyReward ? new Date(this.user.lastDailyReward) : null;
                    this.skins = this.user.skins || ['default'];
                    this.currentSkin = this.user.currentSkin || 'default';
                    this.bonusItems = this.user.bonusItems || {};
                    this.eventProgress = this.user.eventProgress || {};
                    this.updateUI();
                }
            }
            
            async saveUserData() {
                if (this.token) {
                    // –û—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                    if (this.saveTimeout) {
                        clearTimeout(this.saveTimeout);
                    }
                    
                    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    this.saveTimeout = setTimeout(async () => {
                        try {
                            await fetch('/api/update-stats', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': `Bearer ${this.token}`
                                },
                                body: JSON.stringify({
                                    coins: this.coins,
                                    level: this.level,
                                    clicks: this.clicks,
                                    achievements: this.achievements,
                                    bonusItems: this.bonusItems,
                                    eventProgress: this.eventProgress
                                })
                            });
                        } catch (error) {
                            console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                        }
                    }, 1000);
                }
            }
            
            updateUI() {
                const coinsElement = document.getElementById('coins');
                const levelElement = document.getElementById('level');
                const clicksElement = document.getElementById('clicks');
                
                if (coinsElement) coinsElement.textContent = this.coins;
                if (levelElement) levelElement.textContent = this.level;
                if (clicksElement) clicksElement.textContent = this.clicks;
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è
                if (this.level > this.lastLevel) {
                    if (levelElement) {
                        levelElement.classList.add('level-up');
                        this.soundManager.play('levelUp');
                        setTimeout(() => {
                            levelElement.classList.remove('level-up');
                        }, 1000);
                    }
                    this.lastLevel = this.level;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ–Ω—É—Å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                this.updateBonusItems();
            }
            
            async loadLeaderboard() {
                try {
                    const response = await fetch('/api/leaderboard');
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.renderLeaderboard(data.leaderboard);
                    } else {
                        this.showError('leaderboard-list', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
                    this.showError('leaderboard-list', '–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
                }
            }
            
            renderLeaderboard(leaderboard) {
                const leaderboardList = document.getElementById('leaderboard-list');
                if (!leaderboardList) return;
                
                leaderboardList.innerHTML = '';
                
                if (!leaderboard || leaderboard.length === 0) {
                    leaderboardList.innerHTML = '<div class="leaderboard-item"><div class="leaderboard-username">–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤</div></div>';
                    return;
                }
                
                leaderboard.forEach((player) => {
                    const playerElement = document.createElement('div');
                    playerElement.className = 'leaderboard-item';
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ–¥–∞–ª–∏ –¥–ª—è –ø–µ—Ä–≤—ã—Ö –º–µ—Å—Ç
                    let rankDisplay = player.rank;
                    if (player.rank === 1) {
                        rankDisplay = 'ü•á';
                    } else if (player.rank === 2) {
                        rankDisplay = 'ü•à';
                    } else if (player.rank === 3) {
                        rankDisplay = 'ü•â';
                    }
                    
                    playerElement.innerHTML = `
                        <div class="leaderboard-rank">${rankDisplay}</div>
                        <div class="leaderboard-username">${this.escapeHtml(player.username)}</div>
                        <div class="leaderboard-score">${this.formatNumber(player.coins)}</div>
                    `;
                    
                    leaderboardList.appendChild(playerElement);
                });
            }
            
            async loadAchievements() {
                const achievementsList = document.getElementById('achievements-list');
                if (!achievementsList) return;
                
                achievementsList.innerHTML = '';
                
                // –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                const achievements = [
                    { id: 'first_click', name: '–ü–µ—Ä–≤—ã–π –∫–ª–∏–∫', desc: '–°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∫–ª–∏–∫', reward: 10, icon: 'üñ±Ô∏è', condition: (user) => user.clicks >= 1 },
                    { id: 'ten_clicks', name: '–î–µ—Å—è—Ç–æ–∫ –∫–ª–∏–∫–æ–≤', desc: '–°–¥–µ–ª–∞–π—Ç–µ 10 –∫–ª–∏–∫–æ–≤', reward: 50, icon: 'üñ±Ô∏èüñ±Ô∏è', condition: (user) => user.clicks >= 10 },
                    { id: 'hundred_clicks', name: '–°–æ—Ç–Ω—è –∫–ª–∏–∫–æ–≤', desc: '–°–¥–µ–ª–∞–π—Ç–µ 100 –∫–ª–∏–∫–æ–≤', reward: 200, icon: 'üñ±Ô∏èüñ±Ô∏èüñ±Ô∏è', condition: (user) => user.clicks >= 100 },
                    { id: 'first_level', name: '–ü–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å', desc: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 2 —É—Ä–æ–≤–Ω—è', reward: 100, icon: 'üìà', condition: (user) => user.level >= 2 },
                    { id: 'level_5', name: '–ü—è—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å', desc: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 5 —É—Ä–æ–≤–Ω—è', reward: 300, icon: 'üìàüìà', condition: (user) => user.level >= 5 },
                    { id: 'thousand_coins', name: '–¢—ã—Å—è—á–Ω—ã–π —Ä—É–±–µ–∂', desc: '–ù–∞–±–µ—Ä–∏—Ç–µ 1000 –º–æ–Ω–µ—Ç', reward: 500, icon: 'üíé', condition: (user) => user.coins >= 1000 },
                    { id: 'daily_login', name: '–ï–∂–µ–¥–Ω–µ–≤–Ω–∏–∫', desc: '–ü–æ–ª—É—á–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—É 3 –¥–Ω—è –ø–æ–¥—Ä—è–¥', reward: 200, icon: 'üìÖ', condition: (user) => user.dailyStreak >= 3 },
                    { id: 'skin_collector', name: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä', desc: '–ö—É–ø–∏—Ç–µ 3 —Å–∫–∏–Ω–∞', reward: 400, icon: 'üé®', condition: (user) => user.skins.length >= 3 },
                    { id: 'bonus_hunter', name: '–û—Ö–æ—Ç–Ω–∏–∫ –∑–∞ –±–æ–Ω—É—Å–∞–º–∏', desc: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 5 –±–æ–Ω—É—Å–æ–≤', reward: 300, icon: 'üéÅ', condition: (user) => {
                        const totalBonuses = Object.values(user.bonusItems || {}).reduce((sum, count) => sum + count, 0);
                        return totalBonuses >= 5;
                    }},
                    { id: 'event_master', name: '–ú–∞—Å—Ç–µ—Ä —Å–æ–±—ã—Ç–∏–π', desc: '–í—ã–ø–æ–ª–Ω–∏—Ç–µ 2 —Å–æ–±—ã—Ç–∏—è', reward: 600, icon: 'üèÜ', condition: (user) => {
                        const completedEvents = Object.values(user.eventProgress || {}).filter(progress => progress >= 100).length;
                        return completedEvents >= 2;
                    }},
                    { id: 'click_master', name: '–ú–∞—Å—Ç–µ—Ä –∫–ª–∏–∫–æ–≤', desc: '–°–¥–µ–ª–∞–π—Ç–µ 500 –∫–ª–∏–∫–æ–≤', reward: 800, icon: '‚ö°', condition: (user) => user.clicks >= 500 },
                    { id: 'level_10', name: '–î–µ—Å—è—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å', desc: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 —É—Ä–æ–≤–Ω—è', reward: 1000, icon: 'üöÄ', condition: (user) => user.level >= 10 }
                ];
                
                achievements.forEach(achievement => {
                    const isUnlocked = this.achievements[achievement.id] || achievement.condition(this);
                    const isAlreadyClaimed = this.achievements[achievement.id];
                    
                    const achievementElement = document.createElement('div');
                    achievementElement.className = `achievement-item ${isUnlocked ? '' : 'achievement-locked'}`;
                    
                    if (isUnlocked && !isAlreadyClaimed) {
                        achievementElement.innerHTML = `
                            <div class="achievement-icon ${isUnlocked ? '' : 'achievement-locked'}">
                                ${achievement.icon}
                            </div>
                            <div class="achievement-info">
                                <div class="achievement-name">${achievement.name}</div>
                                <div class="achievement-desc">${achievement.desc}</div>
                                <div class="achievement-reward">–ù–∞–≥—Ä–∞–¥–∞: ${achievement.reward} –º–æ–Ω–µ—Ç</div>
                            </div>
                            <button class="achievement-claim-btn" data-achievement="${achievement.id}">–ü–û–õ–£–ß–ò–¢–¨</button>
                        `;
                    } else if (isAlreadyClaimed) {
                        achievementElement.innerHTML = `
                            <div class="achievement-icon ${isUnlocked ? '' : 'achievement-locked'}">
                                ${achievement.icon}
                            </div>
                            <div class="achievement-info">
                                <div class="achievement-name">${achievement.name}</div>
                                <div class="achievement-desc">${achievement.desc}</div>
                                <div class="achievement-reward">–ü–æ–ª—É—á–µ–Ω–æ: ${achievement.reward} –º–æ–Ω–µ—Ç</div>
                            </div>
                            <button class="achievement-claim-btn achievement-claimed" disabled>–ü–û–õ–£–ß–ï–ù–û</button>
                        `;
                    } else {
                        achievementElement.innerHTML = `
                            <div class="achievement-icon ${isUnlocked ? '' : 'achievement-locked'}">
                                ${achievement.icon}
                            </div>
                            <div class="achievement-info">
                                <div class="achievement-name">${achievement.name}</div>
                                <div class="achievement-desc">${achievement.desc}</div>
                                <div class="achievement-reward">–ù–∞–≥—Ä–∞–¥–∞: ${achievement.reward} –º–æ–Ω–µ—Ç</div>
                            </div>
                        `;
                    }
                    
                    achievementsList.appendChild(achievementElement);
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                document.querySelectorAll('.achievement-claim-btn[data-achievement]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const achievementId = e.target.getAttribute('data-achievement');
                        const achievement = achievements.find(a => a.id === achievementId);
                        if (achievement) {
                            this.claimAchievement(achievement);
                        }
                    });
                });
            }
            
            async claimAchievement(achievement) {
                if (this.achievements[achievement.id]) return;
                
                this.achievements[achievement.id] = true;
                this.coins += achievement.reward;
                this.updateUI();
                this.saveUserData();
                
                this.soundManager.play('achievement');
                this.showMessage('achievements-list', `–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ! +${achievement.reward} –º–æ–Ω–µ—Ç`, true);
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                setTimeout(() => {
                    this.loadAchievements();
                }, 1000);
            }
            
            async loadDailyReward() {
                const streakElement = document.getElementById('streak-count');
                const timerElement = document.getElementById('daily-timer');
                const rewardButton = document.getElementById('claim-daily-reward');
                
                if (!streakElement || !timerElement || !rewardButton) return;
                
                if (streakElement) streakElement.textContent = this.dailyStreak;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É
                if (this.lastDailyReward) {
                    const nextReward = new Date(this.lastDailyReward);
                    nextReward.setHours(nextReward.getHours() + 24);
                    const now = new Date();
                    
                    if (now < nextReward) {
                        // –û—Ç—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –Ω–∞–≥—Ä–∞–¥—ã
                        const timeDiff = nextReward - now;
                        const hours = Math.floor(timeDiff / (1000 * 60 * 60));
                        const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                        
                        if (timerElement) timerElement.textContent = `–°–ª–µ–¥—É—é—â–∞—è –Ω–∞–≥—Ä–∞–¥–∞ —á–µ—Ä–µ–∑ ${hours}—á ${minutes}–º`;
                        if (rewardButton) rewardButton.disabled = true;
                    } else {
                        if (timerElement) timerElement.textContent = '–ù–∞–≥—Ä–∞–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞!';
                        if (rewardButton) rewardButton.disabled = false;
                    }
                } else {
                    if (timerElement) timerElement.textContent = '–ü–µ—Ä–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞!';
                    if (rewardButton) rewardButton.disabled = false;
                }
            }
            
            initDailyTimer() {
                setInterval(() => {
                    if (document.getElementById('daily-tab') && 
                        !document.getElementById('daily-tab').classList.contains('hidden')) {
                        this.loadDailyReward();
                    }
                }, 60000); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            }
            
            async claimDailyReward() {
                try {
                    const response = await fetch('/api/daily-reward', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.token}`
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.coins = data.user.coins;
                        this.dailyStreak = data.streak;
                        this.lastDailyReward = new Date();
                        this.updateUI();
                        this.loadDailyReward();
                        this.showMessage('daily-message', data.message, true);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                        this.loadAchievements();
                    } else {
                        this.showMessage('daily-message', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('daily-message', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', false);
                }
            }
            
            async loadSkins() {
                const skinsList = document.getElementById('skins-list');
                if (!skinsList) return;
                
                skinsList.innerHTML = '';
                
                // –°–ø–∏—Å–æ–∫ —Å–∫–∏–Ω–æ–≤
                const skins = [
                    { id: 'default', name: '–û–±—ã—á–Ω—ã–π –∫—Ä–æ—Ç', price: 0 },
                    { id: 'cyber', name: '–ö–∏–±–µ—Ä –∫—Ä–æ—Ç', price: 500 },
                    { id: 'gold', name: '–ó–æ–ª–æ—Ç–æ–π –∫—Ä–æ—Ç', price: 1000 },
                    { id: 'diamond', name: '–ê–ª–º–∞–∑–Ω—ã–π –∫—Ä–æ—Ç', price: 2000 },
                    { id: 'rainbow', name: '–†–∞–¥—É–∂–Ω—ã–π –∫—Ä–æ—Ç', price: 5000 },
                    { id: 'space', name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫—Ä–æ—Ç', price: 3000 },
                    { id: 'fire', name: '–û–≥–Ω–µ–Ω–Ω—ã–π –∫—Ä–æ—Ç', price: 4000 }
                ];
                
                skins.forEach(skin => {
                    const isOwned = this.skins.includes(skin.id);
                    const isCurrent = this.currentSkin === skin.id;
                    
                    const skinElement = document.createElement('div');
                    skinElement.className = `skin-item ${isCurrent ? 'skin-current' : ''}`;
                    
                    skinElement.innerHTML = `
                        <div class="skin-info">
                            <div class="skin-name">${skin.name}</div>
                            ${isOwned ? 
                                `<div class="skin-owned">–ö—É–ø–ª–µ–Ω</div>` : 
                                `<div class="skin-price">${skin.price} –º–æ–Ω–µ—Ç</div>`
                            }
                        </div>
                        ${isCurrent ? 
                            `<button class="skin-equip-btn" disabled>–ù–ê–î–ï–¢–û</button>` :
                            isOwned ? 
                                `<button class="skin-equip-btn" data-skin="${skin.id}">–ù–ê–î–ï–¢–¨</button>` :
                                `<button class="skin-buy-btn" data-skin="${skin.id}" ${this.coins < skin.price ? 'disabled' : ''}>–ö–£–ü–ò–¢–¨</button>`
                        }
                    `;
                    
                    skinsList.appendChild(skinElement);
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                document.querySelectorAll('.skin-equip-btn[data-skin]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const skinId = e.target.getAttribute('data-skin');
                        this.changeSkin(skinId);
                    });
                });
                
                document.querySelectorAll('.skin-buy-btn[data-skin]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const skinId = e.target.getAttribute('data-skin');
                        this.buySkin(skinId);
                    });
                });
            }
            
            async buySkin(skinId) {
                try {
                    const response = await fetch('/api/buy-skin', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.token}`
                        },
                        body: JSON.stringify({ skinId })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.skins = data.user.skins;
                        this.coins = data.user.coins;
                        this.updateUI();
                        this.loadSkins();
                        this.showMessage('skins-list', '–°–∫–∏–Ω —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!', true);
                    } else {
                        this.showMessage('skins-list', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('skins-list', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', false);
                }
            }
            
            async changeSkin(skinId) {
                try {
                    const response = await fetch('/api/change-skin', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.token}`
                        },
                        body: JSON.stringify({ skinId })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.currentSkin = data.user.currentSkin;
                        this.loadSkins();
                        this.showMessage('skins-list', '–°–∫–∏–Ω —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!', true);
                    } else {
                        this.showMessage('skins-list', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('skins-list', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', false);
                }
            }
            
            async loadBonusItems() {
                try {
                    const response = await fetch('/api/bonus-items', {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.token}`
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.bonusItems = data.bonusItems;
                        this.updateBonusItems();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ–Ω—É—Å–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤:', error);
                }
            }
            
            updateBonusItems() {
                const bonusItems = ['double_points', 'auto_click', 'coin_boost', 'lucky_drop'];
                
                bonusItems.forEach(itemId => {
                    const count = this.bonusItems[itemId] || 0;
                    const countElement = document.getElementById(`${itemId}-count`);
                    if (countElement) {
                        countElement.textContent = count;
                    }
                });
            }
            
            async buyBonusItem(itemId) {
                try {
                    const response = await fetch('/api/buy-bonus', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.token}`
                        },
                        body: JSON.stringify({ itemId })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.bonusItems = data.user.bonusItems;
                        this.coins = data.user.coins;
                        this.updateUI();
                        this.updateBonusItems();
                        this.showMessage('bonus-message', '–ü—Ä–µ–¥–º–µ—Ç —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!', true);
                    } else {
                        this.showMessage('bonus-message', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('bonus-message', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', false);
                }
            }
            
            async useBonusItem(itemId) {
                if (!this.bonusItems[itemId] || this.bonusItems[itemId] <= 0) {
                    this.showMessage('bonus-message', '–ü—Ä–µ–¥–º–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', false);
                    return;
                }
                
                try {
                    const response = await fetch('/api/use-bonus', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.token}`
                        },
                        body: JSON.stringify({ itemId })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        this.bonusItems = data.user.bonusItems;
                        this.updateBonusItems();
                        
                        // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç
                        if (data.effect) {
                            if (data.effect.doublePoints) {
                                this.doublePointsActive = true;
                                this.doublePointsTime = data.effect.doublePointsTime;
                                this.showMessage('bonus-message', data.message, true);
                                this.startDoublePointsTimer();
                            } else if (data.effect.autoClicks) {
                                // –ê–≤—Ç–æ–∫–ª–∏–∫–∏
                                for (let i = 0; i < data.effect.autoClicks; i++) {
                                    setTimeout(() => {
                                        this.simulateClick();
                                    }, i * 100);
                                }
                                this.showMessage('bonus-message', data.message, true);
                            } else if (data.effect.coinBoost) {
                                this.coins += data.effect.coinBoost;
                                this.updateUI();
                                this.showMessage('bonus-message', data.message, true);
                            }
                        }
                    } else {
                        this.showMessage('bonus-message', data.error, false);
                    }
                } catch (error) {
                    this.showMessage('bonus-message', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', false);
                }
            }
            
            startDoublePointsTimer() {
                const timer = setInterval(() => {
                    this.doublePointsTime--;
                    if (this.doublePointsTime <= 0) {
                        this.doublePointsActive = false;
                        clearInterval(timer);
                        this.showMessage('bonus-message', '–£–¥–≤–æ–µ–Ω–∏–µ –º–æ–Ω–µ—Ç –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å', true);
                    }
                }, 1000);
            }
            
            async loadEvents() {
                const eventsList = document.getElementById('events-list');
                if (!eventsList) return;
                
                eventsList.innerHTML = '';
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
                const events = [
                    { 
                        id: 'click_challenge', 
                        title: '–ö–ª–∏–∫-—á–µ–ª–ª–µ–Ω–¥–∂', 
                        desc: '–°–¥–µ–ª–∞–π—Ç–µ 25 –∫–ª–∏–∫–æ–≤', 
                        target: 25,
                        reward: '200 –º–æ–Ω–µ—Ç + 1 –±–æ–Ω—É—Å–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç',
                        type: 'clicks'
                    },
                    { 
                        id: 'level_up', 
                        title: '–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è', 
                        desc: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ —É—Ä–æ–≤–Ω—è 3', 
                        target: 3,
                        reward: '300 –º–æ–Ω–µ—Ç',
                        type: 'level'
                    },
                    { 
                        id: 'coin_sprint', 
                        title: '–°–ø—Ä–∏–Ω—Ç –º–æ–Ω–µ—Ç', 
                        desc: '–ù–∞–±–µ—Ä–∏—Ç–µ 500 –º–æ–Ω–µ—Ç', 
                        target: 500,
                        reward: '400 –º–æ–Ω–µ—Ç + 2 –±–æ–Ω—É—Å–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–∞',
                        type: 'coins'
                    },
                    { 
                        id: 'daily_login', 
                        title: '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥', 
                        desc: '–í–æ–π–¥–∏—Ç–µ –≤ –∏–≥—Ä—É —Å–µ–≥–æ–¥–Ω—è', 
                        target: 1,
                        reward: '100 –º–æ–Ω–µ—Ç',
                        type: 'login'
                    },
                    { 
                        id: 'combo_click', 
                        title: '–ö–æ–º–±–æ-–∫–ª–∏–∫', 
                        desc: '–°–¥–µ–ª–∞–π—Ç–µ 5 –∫–ª–∏–∫–æ–≤ –ø–æ–¥—Ä—è–¥ –∑–∞ 5 —Å–µ–∫—É–Ω–¥', 
                        target: 5,
                        reward: '500 –º–æ–Ω–µ—Ç',
                        type: 'combo'
                    },
                    { 
                        id: 'skin_challenge', 
                        title: '–ö–æ–ª–ª–µ–∫—Ü–∏—è —Å–∫–∏–Ω–æ–≤', 
                        desc: '–ö—É–ø–∏—Ç–µ 2 –Ω–æ–≤—ã—Ö —Å–∫–∏–Ω–∞', 
                        target: 2,
                        reward: '600 –º–æ–Ω–µ—Ç + 1 —Ä–µ–¥–∫–∏–π –ø—Ä–µ–¥–º–µ—Ç',
                        type: 'skins'
                    },
                    { 
                        id: 'achievement_hunter', 
                        title: '–û—Ö–æ—Ç–Ω–∏–∫ –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏', 
                        desc: '–ü–æ–ª—É—á–∏—Ç–µ 3 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è', 
                        target: 3,
                        reward: '800 –º–æ–Ω–µ—Ç + 3 –±–æ–Ω—É—Å–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–∞',
                        type: 'achievements'
                    }
                ];
                
                events.forEach(event => {
                    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
                    let progress = 0;
                    switch(event.type) {
                        case 'clicks':
                            progress = Math.min(100, (this.clicks / event.target) * 100);
                            break;
                        case 'level':
                            progress = Math.min(100, (this.level / event.target) * 100);
                            break;
                        case 'coins':
                            progress = Math.min(100, (this.coins / event.target) * 100);
                            break;
                        case 'login':
                            progress = 100; // –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –µ—Å–ª–∏ –≤–æ—à–µ–ª
                            break;
                        case 'skins':
                            progress = Math.min(100, ((this.skins.length - 1) / event.target) * 100);
                            break;
                        case 'achievements':
                            const completedAchievements = Object.values(this.achievements).filter(Boolean).length;
                            progress = Math.min(100, (completedAchievements / event.target) * 100);
                            break;
                        default:
                            progress = 0;
                    }
                    
                    const eventElement = document.createElement('div');
                    eventElement.className = 'event-item';
                    
                    eventElement.innerHTML = `
                        <div class="event-title">${event.title}</div>
                        <div class="event-desc">${event.desc}</div>
                        <div class="event-progress">
                            <div class="event-progress-bar" style="width: ${progress}%"></div>
                        </div>
                        <div class="event-info">
                            <span>${Math.round(progress)}%</span>
                        </div>
                        <div class="event-reward">–ù–∞–≥—Ä–∞–¥–∞: ${event.reward}</div>
                    `;
                    
                    eventsList.appendChild(eventElement);
                });
            }
            
            simulateClick() {
                this.clicks++;
                const coins = this.doublePointsActive ? this.level * 2 : this.level;
                this.coins += coins;
                this.updateUI();
                this.saveUserData();
                
                // –ê–Ω–∏–º–∞—Ü–∏—è
                const mole = document.getElementById('mole');
                if (mole) {
                    mole.style.transform = 'scale(0.92)';
                    setTimeout(() => {
                        mole.style.transform = 'scale(1)';
                    }, 100);
                }
            }
            
            showError(containerId, message) {
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = `<div class="message error" style="margin: 20px;">${message}</div>`;
                }
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            formatNumber(num) {
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
            }
            
            tap(e) {
                this.clicks++;
                const coins = this.doublePointsActive ? this.level * 2 : this.level;
                this.coins += coins;
                
                // –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 —É–¥–∞—Ä–æ–≤
                const newLevel = Math.floor(this.clicks / 10) + 1;
                if (newLevel > this.level) {
                    this.level = newLevel;
                }
                
                this.updateUI();
                this.saveUserData();
                this.soundManager.play('tap');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                this.checkAchievements();
                
                // –ê–Ω–∏–º–∞—Ü–∏—è
                const mole = document.getElementById('mole');
                if (mole) {
                    mole.style.transform = 'scale(0.92)';
                    setTimeout(() => {
                        mole.style.transform = 'scale(1)';
                    }, 100);
                }
                
                // –≠—Ñ—Ñ–µ–∫—Ç –≤–æ–ª–Ω—ã
                if (e) {
                    const moleWrapper = document.querySelector('.mole-wrapper');
                    if (moleWrapper) {
                        const rect = mole.getBoundingClientRect();
                        const wrapperRect = moleWrapper.getBoundingClientRect();
                        
                        const x = e.clientX - wrapperRect.left;
                        const y = e.clientY - wrapperRect.top;
                        
                        const effect = document.createElement('div');
                        effect.className = 'tap-effect';
                        effect.style.left = x + 'px';
                        effect.style.top = y + 'px';
                        moleWrapper.appendChild(effect);
                        
                        setTimeout(() => {
                            effect.remove();
                        }, 600);
                    }
                }
            }
            
            checkAchievements() {
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                if (document.getElementById('achievements-tab') && 
                    !document.getElementById('achievements-tab').classList.contains('hidden')) {
                    this.loadAchievements();
                }
            }
            
            logout() {
                this.soundManager.play('logout');
                this.token = null;
                this.user = null;
                localStorage.removeItem('token');
                this.stopAutoRefresh();
                this.showScreen('login-screen');
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            window.game = new Game();
        });
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
    </script>
</body>
</html>
